@model PagedList.IPagedList<GeneratorBase.MVC.Models.T_Address>
@using PagedList.Mvc;
@{
    ViewBag.Title = "Index";
    Layout = null;
    Response.ContentType = "application/vnd.ms-excel";
    Response.AddHeader("Content-Disposition", "attachment; filename=Address.xls");
}
                    <table>
                            <tr>
@if(User.CanView("T_Address","T_AddressLine1"))
{
		<th>AddressLine1</th>
}
@if(User.CanView("T_Address","T_AddressLine2"))
{
		<th>AddressLine2</th>
}
@if(User.CanView("T_Address","T_ZipCode"))
{
		<th>ZipCode</th>
}
@if(User.CanView("T_Address","T_AddressCountryID"))
{
		<th  @(Convert.ToString(ViewData["HostingEntity"]) == "T_Country"?"hidden":"")>Address Country</th>
}
@if(User.CanView("T_Address","T_AddressStateID"))
{
		<th  @(Convert.ToString(ViewData["HostingEntity"]) == "T_State"?"hidden":"")>Address State</th>
}
@if(User.CanView("T_Address","T_AddressCityID"))
{
		<th  @(Convert.ToString(ViewData["HostingEntity"]) == "T_City"?"hidden":"")>Address City</th>
}
    </tr>
@foreach (var item in Model) {
    <tr>
	@if(User.CanView("T_Address","T_AddressLine1"))
{
		<td>
            @Html.DisplayFor(modelItem => item.T_AddressLine1)
        </td>
}
@if(User.CanView("T_Address","T_AddressLine2"))
{
		<td>
            @Html.DisplayFor(modelItem => item.T_AddressLine2)
        </td>
}
@if(User.CanView("T_Address","T_ZipCode"))
{
		<td>
            @Html.DisplayFor(modelItem => item.T_ZipCode)
        </td>
}
@if(User.CanView("T_Address","T_AddressCountryID"))
{
		<td @(Convert.ToString(ViewData["HostingEntity"]) == "T_Country"?"hidden":"")>
            @Html.DisplayFor(modelItem => item.t_addresscountry.DisplayValue)
        </td>
}
@if(User.CanView("T_Address","T_AddressStateID"))
{
		<td @(Convert.ToString(ViewData["HostingEntity"]) == "T_State"?"hidden":"")>
            @Html.DisplayFor(modelItem => item.t_addressstate.DisplayValue)
        </td>
}
@if(User.CanView("T_Address","T_AddressCityID"))
{
		<td @(Convert.ToString(ViewData["HostingEntity"]) == "T_City"?"hidden":"")>
            @Html.DisplayFor(modelItem => item.t_addresscity.DisplayValue)
        </td>
}
                                </tr>
                            }
</table>
               

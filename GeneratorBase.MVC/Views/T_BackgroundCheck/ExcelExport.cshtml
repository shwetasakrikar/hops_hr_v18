@model PagedList.IPagedList<GeneratorBase.MVC.Models.T_BackgroundCheck>
@using PagedList.Mvc;
@{
    ViewBag.Title = "Index";
    Layout = null;
    Response.ContentType = "application/vnd.ms-excel";
    Response.AddHeader("Content-Disposition", "attachment; filename=Background Check.xls");
}
                    <table>
                            <tr>
@if(User.CanView("T_BackgroundCheck","T_EmployeeCriminalBackgroundCheckID"))
{
		<th  @(Convert.ToString(ViewData["HostingEntity"]) == "T_Employee"?"hidden":"")>Employee</th>
}
@if(User.CanView("T_BackgroundCheck","T_RetainTablePreEmploymentCheckID"))
{
		<th  @(Convert.ToString(ViewData["HostingEntity"]) == "T_RetainTable"?"hidden":"")>Employment Decision</th>
}
@if(User.CanView("T_BackgroundCheck","T_DateFingerPrintTaken"))
{
		<th>Date Finger Print Taken</th>
}
@if(User.CanView("T_BackgroundCheck","T_DateInformationReceivedFromCBC"))
{
		<th>VSP Response Rcvd Date</th>
}
@if(User.CanView("T_BackgroundCheck","T_PreEmploymentCheckResultsVAStateID"))
{
		<th  @(Convert.ToString(ViewData["HostingEntity"]) == "T_ResultsTable"?"hidden":"")>VSP Initial Results</th>
}
@if(User.CanView("T_BackgroundCheck","T_BackgroundDispositionDate"))
{
		<th>FBI Record Received Date </th>
}
@if(User.CanView("T_BackgroundCheck","T_ReviewDate"))
{
		<th>Review Date</th>
}
@if(User.CanView("T_BackgroundCheck","T_ReviewerID"))
{
		<th  @(Convert.ToString(ViewData["HostingEntity"]) == "T_Employee"?"hidden":"")>Reviewer </th>
}
@if(User.CanView("T_BackgroundCheck","T_DateCheckInitiated"))
{
		<th>Date Check Initiated</th>
}
@if(User.CanView("T_BackgroundCheck","T_DateCPSResultReceived"))
{
		<th>Date CPS Result Received</th>
}
@if(User.CanView("T_BackgroundCheck","T_CPSResultID"))
{
		<th  @(Convert.ToString(ViewData["HostingEntity"]) == "T_CPSResults"?"hidden":"")>CPS Result </th>
}
@if(User.CanView("T_BackgroundCheck","T_CPSReviewDate"))
{
		<th>CPS Review Date</th>
}
@if(User.CanView("T_BackgroundCheck","T_Notes"))
{
		<th>Notes</th>
}
    </tr>
@foreach (var item in Model) {
    <tr>
	@if(User.CanView("T_BackgroundCheck","T_EmployeeCriminalBackgroundCheckID"))
{
		<td @(Convert.ToString(ViewData["HostingEntity"]) == "T_Employee"?"hidden":"")>
            @Html.DisplayFor(modelItem => item.t_employeecriminalbackgroundcheck.DisplayValue)
        </td>
}
@if(User.CanView("T_BackgroundCheck","T_RetainTablePreEmploymentCheckID"))
{
		<td @(Convert.ToString(ViewData["HostingEntity"]) == "T_RetainTable"?"hidden":"")>
            @Html.DisplayFor(modelItem => item.t_retaintablepreemploymentcheck.DisplayValue)
        </td>
}
@if(User.CanView("T_BackgroundCheck","T_DateFingerPrintTaken"))
{
		<td>
            @Html.DisplayFor(modelItem => item.T_DateFingerPrintTaken)
        </td>
}
@if(User.CanView("T_BackgroundCheck","T_DateInformationReceivedFromCBC"))
{
		<td>
            @Html.DisplayFor(modelItem => item.T_DateInformationReceivedFromCBC)
        </td>
}
@if(User.CanView("T_BackgroundCheck","T_PreEmploymentCheckResultsVAStateID"))
{
		<td @(Convert.ToString(ViewData["HostingEntity"]) == "T_ResultsTable"?"hidden":"")>
            @Html.DisplayFor(modelItem => item.t_preemploymentcheckresultsvastate.DisplayValue)
        </td>
}
@if(User.CanView("T_BackgroundCheck","T_BackgroundDispositionDate"))
{
		<td>
            @Html.DisplayFor(modelItem => item.T_BackgroundDispositionDate)
        </td>
}
@if(User.CanView("T_BackgroundCheck","T_ReviewDate"))
{
		<td>
            @Html.DisplayFor(modelItem => item.T_ReviewDate)
        </td>
}
@if(User.CanView("T_BackgroundCheck","T_ReviewerID"))
{
		<td @(Convert.ToString(ViewData["HostingEntity"]) == "T_Employee"?"hidden":"")>
            @Html.DisplayFor(modelItem => item.t_reviewer.DisplayValue)
        </td>
}
@if(User.CanView("T_BackgroundCheck","T_DateCheckInitiated"))
{
		<td>
            @Html.DisplayFor(modelItem => item.T_DateCheckInitiated)
        </td>
}
@if(User.CanView("T_BackgroundCheck","T_DateCPSResultReceived"))
{
		<td>
            @Html.DisplayFor(modelItem => item.T_DateCPSResultReceived)
        </td>
}
@if(User.CanView("T_BackgroundCheck","T_CPSResultID"))
{
		<td @(Convert.ToString(ViewData["HostingEntity"]) == "T_CPSResults"?"hidden":"")>
            @Html.DisplayFor(modelItem => item.t_cpsresult.DisplayValue)
        </td>
}
@if(User.CanView("T_BackgroundCheck","T_CPSReviewDate"))
{
		<td>
            @Html.DisplayFor(modelItem => item.T_CPSReviewDate)
        </td>
}
@if(User.CanView("T_BackgroundCheck","T_Notes"))
{
		<td>
            @Html.DisplayFor(modelItem => item.T_Notes)
        </td>
}
                                </tr>
                            }
</table>
               
